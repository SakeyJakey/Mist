package dev.sakey.mist.modules.impl.exploit;

import dev.sakey.mist.Mist;
import dev.sakey.mist.events.Direction;
import dev.sakey.mist.events.EventHandler;
import dev.sakey.mist.events.impl.client.EventPacket;
import dev.sakey.mist.modules.Category;
import dev.sakey.mist.modules.Module;
import dev.sakey.mist.modules.annotations.ModuleInfo;
import net.minecraft.network.play.server.S14PacketEntity;

public class Canceller extends Module {

	EventHandler<EventPacket> eventPacket = e -> {
		if (e.getDirection() == Direction.OUT) return;

		if (e.getPacket() instanceof S14PacketEntity.S16PacketEntityLook packet) {
			if (packet.getEntity(mc.theWorld) == mc.thePlayer)
				e.setCancelled(true);
		}
	};

	@ModuleInfo(name = "Canceller", description = "Cancels dumb server packets.", category = Category.EXPLOIT)
	public Canceller() {
	}

	public void onEnable() {
		Mist.instance.getEventManager().registerEventHandler(EventPacket.class, eventPacket);
	}

	public void onDisable() {
		Mist.instance.getEventManager().unregisterEventHandler(eventPacket);
	}
}