package dev.sakey.mist.modules.impl.exploit;

import dev.sakey.mist.Mist;
import dev.sakey.mist.events.Direction;
import dev.sakey.mist.events.EventHandler;
import dev.sakey.mist.events.impl.client.EventPacket;
import dev.sakey.mist.events.impl.flag.EventLagback;
import dev.sakey.mist.events.impl.flag.EventWorldChange;
import dev.sakey.mist.modules.Category;
import dev.sakey.mist.modules.Module;
import dev.sakey.mist.modules.annotations.ModuleInfo;
import dev.sakey.mist.utils.client.TimerUtil;
import net.minecraft.network.play.server.S08PacketPlayerPosLook;
import net.minecraft.network.play.server.S14PacketEntity;
import net.minecraft.network.play.server.S19PacketEntityHeadLook;
import net.minecraft.network.play.server.S2FPacketSetSlot;
import org.lwjgl.input.Keyboard;

public class Canceller extends Module {

    @ModuleInfo(name = "Canceller", description = "Cancels dumb server packets.", category = Category.EXPLOIT)
    public Canceller() { }

    public void onEnable(){
        Mist.instance.getEventManager().registerEventHandler(EventPacket.class, eventPacket);
    }
    public void onDisable(){
        Mist.instance.getEventManager().unregisterEventHandler(eventPacket);
    }

    EventHandler<EventPacket> eventPacket = e -> {
        if(e.getDirection() == Direction.OUT) return;

        if (e.getPacket() instanceof S14PacketEntity.S16PacketEntityLook) {
            S14PacketEntity.S16PacketEntityLook packet = (S14PacketEntity.S16PacketEntityLook) e.getPacket();
            if(packet.getEntity(mc.theWorld) == mc.thePlayer)
                e.setCancelled(true);
        }
    };
}